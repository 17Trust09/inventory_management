{# inventory/templates/inventory/admin_borrowed_items_list.html #}
{% extends 'inventory/admin_base.html' %}

{% block admin_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h3 class="mb-0"><i class="bi bi-arrow-left-right me-2"></i>Entleihvorgänge</h3>
</div>

<div class="card shadow-sm" style="background:var(--surface); border:1px solid var(--border); border-radius:.75rem;">
  <div class="table-responsive">
    <table class="table table-striped align-middle mb-0" style="background:var(--surface); color:var(--text); border:1px solid var(--border);">
      <thead style="background:var(--surface-2); color:var(--text);">
        <tr>
          <th>Artikel</th>
          <th>Entleiher</th>
          <th>Anzahl</th>
          <th>Ausgeliehen</th>
          <th>Zurückgegeben</th>
          <th class="text-end">Aktion</th>
        </tr>
      </thead>
      <tbody>
        {% for b in borrowed_items %}
        <tr>
          <td>{{ b.item.name }}</td>
          <td>{{ b.borrower }}</td>
          <td>{{ b.quantity_borrowed }}</td>
          <td>{{ b.borrowed_at|date:"d.m.Y H:i" }}</td>
          <td>
            {% if b.returned %}
              <span class="badge bg-success">
                <i class="bi bi-check-circle me-1"></i> Ja ({{ b.returned_at|date:"d.m.Y" }})
              </span>
            {% else %}
              {% if b.is_overdue %}
                <span class="badge bg-danger">
                  <i class="bi bi-exclamation-triangle me-1"></i>
                  Überfällig{% if b.return_date %} ({{ b.return_date|date:"d.m.Y" }}){% endif %}
                </span>
              {% else %}
                <span class="badge bg-warning text-dark">
                  <i class="bi bi-hourglass-split me-1"></i>
                  Offen{% if b.return_date %} ({{ b.return_date|date:"d.m.Y" }}){% endif %}
                </span>
              {% endif %}
            {% endif %}
          </td>
          <td class="text-end">
            {% if not b.returned %}
              <a href="{% url 'return-item' b.pk %}" class="btn btn-sm btn-outline-light">
                <i class="bi bi-arrow-counterclockwise me-1"></i> Rückgabe
              </a>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center text-muted py-4">Keine Entleihvorgänge.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
